# Vendor Order Queries
# Week 7: Order Management & Fulfillment for Vendors

query OrdersByVendor($vendorId: ID!, $pagination: PaginationInput) {
  ordersByVendor(vendorId: $vendorId, pagination: $pagination) {
    items {
      id
      orderNumber
      spaOrganizationId
      placedByUserId
      placedAt
      fulfillmentStatus
      paymentStatus
      total
      itemCount
      vendorCount
      vendorOrders {
        vendorId
        orderLineIds
        subtotal
        shippingCost
        vendorTotal
        fulfillmentStatus
        trackingNumber
        estimatedDelivery
        shippedAt
      }
    }
    totalCount
  }
}

query VendorOrderDetail($id: ID!) {
  order(id: $id) {
    id
    orderNumber
    spaOrganizationId
    placedByUserId
    placedAt
    fulfillmentStatus
    paymentStatus
    total
    itemCount
    vendorCount
    vendorOrders {
      vendorId
      orderLineIds
      subtotal
      shippingCost
      vendorTotal
      fulfillmentStatus
      trackingNumber
      estimatedDelivery
      shippedAt
    }
    lines {
      id
      productVariant {
        id
        name
        sku
        product {
          id
          name
          featuredAsset {
            preview
          }
        }
      }
      quantity
      unitPrice
      linePrice
    }
    shippingAddress {
      firstName
      lastName
      company
      street
      street2
      city
      state
      zipCode
      country
      phone
    }
    billingAddress {
      firstName
      lastName
      company
      street
      street2
      city
      state
      zipCode
      country
      phone
    }
    subtotal
    tax
    shipping
    discount
    notes
    fulfilledAt
  }
}

mutation UpdateVendorFulfillment(
  $orderId: ID!
  $vendorId: ID!
  $status: FulfillmentStatus!
  $trackingNumber: String
) {
  updateFulfillment(
    orderId: $orderId
    vendorId: $vendorId
    status: $status
    trackingNumber: $trackingNumber
  ) {
    id
    orderNumber
    fulfillmentStatus
    vendorOrders {
      vendorId
      fulfillmentStatus
      trackingNumber
      shippedAt
    }
  }
}
